exports.id=168,exports.ids=[168],exports.modules={8126:(a,b,c)=>{Promise.resolve().then(c.bind(c,98580))},20814:(a,b,c)=>{"use strict";c.d(b,{S:()=>g});var d=c(76055);let e="https://nugjghwkvfkdbgrgsazv.supabase.co",f="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51Z2pnaHdrdmZrZGJncmdzYXp2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5MjM3NzMsImV4cCI6MjA3MzQ5OTc3M30.6iaRtFDTdss9YgKaPYnP63A1TC2FNqN4ywPlRnrrssA";if(!e||!f)throw Error("Missing Supabase environment variables. Please check NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.");let g=()=>(0,d.createBrowserClient)(e,f,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}})},23503:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},28517:(a,b,c)=>{"use strict";c.d(b,{MainLayout:()=>Q});var d=c(21124),e=c(42378),f=c(38301),g=c(3991),h=c.n(g),i=c(47268),j=c(69470),k=c(94684),l=c(19710),m=c(35284),n=c(88285),o=c(81925),p=c(93758),q=c(62186),r=c(99187),s=c(30295),t=c(20814);class u{async getFolders(a){let{data:b,error:c}=await this.supabase.from("folders").select(`
        *,
        documents(count)
      `).eq("user_id",a).order("created_at",{ascending:!0});if(c)throw Error(`Failed to fetch folders: ${c.message}`);let d=new Map,e=[];return b.forEach(a=>{let b={...a,children:[],document_count:a.documents?.[0]?.count||0};d.set(a.id,b)}),b.forEach(a=>{let b=d.get(a.id);if(a.parent_id){let c=d.get(a.parent_id);c&&c.children.push(b)}else e.push(b)}),e}async getFolder(a,b){let{data:c,error:d}=await this.supabase.from("folders").select("*").eq("id",a).eq("user_id",b).single();if(d)throw Error(`Failed to fetch folder: ${d.message}`);return c}async createFolder(a){let{data:b,error:c}=await this.supabase.from("folders").insert(a).select().single();if(c)throw Error(`Failed to create folder: ${c.message}`);return b}async updateFolder(a,b,c){let{data:d,error:e}=await this.supabase.from("folders").update(b).eq("id",a).eq("user_id",c).select().single();if(e)throw Error(`Failed to update folder: ${e.message}`);return d}async deleteFolder(a,b){let{data:c,error:d}=await this.supabase.from("folders").select("id").eq("parent_id",a).eq("user_id",b);if(d)throw Error(`Failed to check folder children: ${d.message}`);if(c&&c.length>0)throw Error("Cannot delete folder with subfolders. Please delete subfolders first.");let{data:e,error:f}=await this.supabase.from("documents").select("id").eq("folder_id",a).eq("user_id",b);if(f)throw Error(`Failed to check folder documents: ${f.message}`);if(e&&e.length>0)throw Error("Cannot delete folder containing documents. Please move or delete documents first.");let{error:g}=await this.supabase.from("folders").delete().eq("id",a).eq("user_id",b);if(g)throw Error(`Failed to delete folder: ${g.message}`);return{success:!0}}async moveFolder(a,b,c){if(b&&await this.checkCircularReference(a,b,c))throw Error("Cannot move folder: this would create a circular reference");return this.updateFolder(a,{parent_id:b},c)}async checkCircularReference(a,b,c){let d=b;for(;d;){if(d===a)return!0;let{data:b,error:e}=await this.supabase.from("folders").select("parent_id").eq("id",d).eq("user_id",c).single();if(e||!b)break;d=b.parent_id}return!1}async getFolderPath(a,b){let c=[],d=a;for(;d;){let a=await this.getFolder(d,b);c.unshift(a),d=a.parent_id}return c}async getFolderStats(a){let{data:b,error:c}=await this.supabase.from("folders").select("safe_artifact").eq("user_id",a);if(c)throw Error(`Failed to fetch folder stats: ${c.message}`);let d={total:b.length,bySafeArtifact:{}};return b.forEach(a=>{a.safe_artifact&&(d.bySafeArtifact[a.safe_artifact]=(d.bySafeArtifact[a.safe_artifact]||0)+1)}),d}async searchFolders(a,b){let{data:c,error:d}=await this.supabase.from("folders").select("*").eq("user_id",a).ilike("name",`%${b}%`).order("name",{ascending:!0});if(d)throw Error(`Failed to search folders: ${d.message}`);return c}constructor(){this.supabase=(0,t.S)()}}let v=new u;var w=c(76042),x=c(44943);function y({onResultSelect:a,placeholder:b="Search documents, notes, and audio...",showFilters:c=!0}){let[e,g]=(0,f.useState)(""),[h,i]=(0,f.useState)([]),[k,l]=(0,f.useState)(!1),[t,u]=(0,f.useState)(!1),[y,z]=(0,f.useState)({}),{user:A}=(0,w.A)();!function(a,b){let[c,d]=(0,f.useState)(a)}(e,0),(0,f.useCallback)(async(a,b)=>{if(!A||!a.trim())return void i([]);l(!0);try{let[c,d]=await Promise.all([s.W.searchDocuments(A.id,a,{artifactType:b.artifactType,priority:b.priority,tags:b.tags}),v.searchFolders(A.id,a)]),e=[...c.map(a=>({type:"document",id:a.id,title:a.title,content:a.content,snippet:a.content.substring(0,150)+"...",metadata:{fileType:a.file_type,artifactType:a.artifact_type,priority:a.priority,tags:a.tags,fileSize:a.file_size,updatedAt:a.updated_at}})),...d.map(a=>({type:"folder",id:a.id,title:a.name,metadata:{safeArtifact:a.safe_artifact,parentId:a.parent_id,updatedAt:a.updated_at}}))];i(e)}catch(a){console.error("Search failed:",a),i([])}finally{l(!1)}},[A]);let B=(a,b)=>{if(!b.trim())return a;let c=RegExp(`(${b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return a.split(c).map((a,b)=>c.test(a)?(0,d.jsx)("mark",{className:"bg-yellow-200 text-yellow-900 px-1 rounded",children:a},b):a)},C=Object.values(y).filter(Boolean).length;return(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(n.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[var(--muted-foreground)] w-4 h-4"}),(0,d.jsx)(p.p,{value:e,onChange:a=>g(a.target.value),placeholder:b,className:"pl-10 pr-20"}),c&&(0,d.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center space-x-1",children:[C>0&&(0,d.jsx)(r.E,{variant:"secondary",className:"text-xs",children:C}),(0,d.jsx)(m.$,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>u(!t),children:(0,d.jsx)(o.A,{className:"w-4 h-4"})}),e&&(0,d.jsx)(m.$,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>g(""),children:(0,d.jsx)(j.A,{className:"w-4 h-4"})})]})]}),t&&(0,d.jsxs)(q.Zp,{className:"absolute top-full left-0 right-0 mt-2 z-50 shadow-lg",children:[(0,d.jsx)(q.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(q.ZB,{className:"text-sm",children:"Search Filters"}),(0,d.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>{z({})},children:"Clear All"})]})}),(0,d.jsxs)(q.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Artifact Type"}),(0,d.jsxs)("select",{value:y.artifactType||"",onChange:a=>z(b=>({...b,artifactType:a.target.value||void 0})),className:"w-full px-3 py-2 border border-[var(--border)] rounded-md text-sm",children:[(0,d.jsx)("option",{value:"",children:"All Types"}),(0,d.jsx)("option",{value:"Epic",children:"Epic"}),(0,d.jsx)("option",{value:"Feature",children:"Feature"}),(0,d.jsx)("option",{value:"User Story",children:"User Story"}),(0,d.jsx)("option",{value:"Capability",children:"Capability"}),(0,d.jsx)("option",{value:"Solution",children:"Solution"}),(0,d.jsx)("option",{value:"Theme",children:"Theme"}),(0,d.jsx)("option",{value:"Enabler",children:"Enabler"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Priority"}),(0,d.jsxs)("select",{value:y.priority||"",onChange:a=>z(b=>({...b,priority:a.target.value||void 0})),className:"w-full px-3 py-2 border border-[var(--border)] rounded-md text-sm",children:[(0,d.jsx)("option",{value:"",children:"All Priorities"}),(0,d.jsx)("option",{value:"High",children:"High"}),(0,d.jsx)("option",{value:"Medium",children:"Medium"}),(0,d.jsx)("option",{value:"Low",children:"Low"})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"File Type"}),(0,d.jsxs)("select",{value:y.fileType||"",onChange:a=>z(b=>({...b,fileType:a.target.value||void 0})),className:"w-full px-3 py-2 border border-[var(--border)] rounded-md text-sm",children:[(0,d.jsx)("option",{value:"",children:"All File Types"}),(0,d.jsx)("option",{value:"pdf",children:"PDF"}),(0,d.jsx)("option",{value:"docx",children:"DOCX"}),(0,d.jsx)("option",{value:"txt",children:"TXT"}),(0,d.jsx)("option",{value:"md",children:"Markdown"})]})]})]})]}),(e||h.length>0)&&(0,d.jsx)(q.Zp,{className:"absolute top-full left-0 right-0 mt-2 z-40 max-h-96 overflow-y-auto shadow-lg",children:(0,d.jsx)(q.Wu,{className:"p-0",children:k?(0,d.jsx)("div",{className:"p-4 text-center text-[var(--muted-foreground)]",children:"Searching..."}):h.length>0?(0,d.jsx)("div",{className:"space-y-0",children:h.map(b=>(0,d.jsx)("div",{className:"p-4 hover:bg-[var(--muted)] cursor-pointer border-b border-[var(--border)] last:border-0",onClick:()=>a?.(b),children:(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("div",{className:"text-2xl mt-1",children:(a=>{switch(a.type){case"document":return(0,x.oP)(a.metadata?.fileType||"txt");case"folder":return"\uD83D\uDCC1";case"note":return"\uD83D\uDCDD";case"audio":return"\uD83C\uDFB5";default:return"\uD83D\uDCC4"}})(b)}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,d.jsx)("h4",{className:"font-medium text-sm truncate",children:B(b.title,e)}),(0,d.jsx)(r.E,{variant:"outline",className:"text-xs",children:b.type})]}),b.snippet&&(0,d.jsx)("p",{className:"text-xs text-[var(--muted-foreground)] line-clamp-2",children:B(b.snippet,e)}),(0,d.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[b.metadata?.artifactType&&(0,d.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${(0,x.fK)(b.metadata.artifactType)}`,children:b.metadata.artifactType}),b.metadata?.priority&&(0,d.jsxs)("span",{className:"text-xs text-[var(--muted-foreground)]",children:[b.metadata.priority," Priority"]}),b.metadata?.fileSize&&(0,d.jsx)("span",{className:"text-xs text-[var(--muted-foreground)]",children:(0,x.z3)(b.metadata.fileSize)})]})]})]})},`${b.type}-${b.id}`))}):e?(0,d.jsxs)("div",{className:"p-4 text-center text-[var(--muted-foreground)]",children:['No results found for "',e,'"']}):null})})]})}function z(){let{user:a,signOut:b}=(0,w.A)(),c=(0,e.usePathname)(),[g,n]=(0,f.useState)([]),[o,p]=(0,f.useState)(0),[q,r]=(0,f.useState)(!1),[s,u]=(0,f.useState)(!1);(0,t.S)();let v=async a=>{try{(await fetch("/api/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationId:a,read:!0})})).ok&&(n(b=>b.map(b=>b.id===a?{...b,read:!0}:b)),p(a=>Math.max(0,a-1)))}catch(a){console.error("Error marking notification as read:",a)}},x=async()=>{u(!0);try{let a=g.filter(a=>!a.read);await Promise.all(a.map(a=>v(a.id)))}catch(a){console.error("Error marking all as read:",a)}finally{u(!1)}};return(0,d.jsxs)("header",{className:"h-16 border-b border-[var(--border)] bg-[var(--card)] px-6 flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,d.jsxs)(h(),{href:"/dashboard",className:"flex items-center space-x-2",children:[(0,d.jsx)("div",{className:"w-8 h-8 bg-[var(--primary-green)] rounded-lg flex items-center justify-center",children:(0,d.jsx)("span",{className:"text-white font-bold text-sm",children:"DA"})}),(0,d.jsx)("h1",{className:"text-xl font-bold text-[var(--foreground)]",children:"Document AI Assistant"})]}),(0,d.jsx)("nav",{className:"hidden md:flex items-center space-x-4",children:[{href:"/dashboard",label:"Dashboard"},{href:"/documents",label:"Documents"},{href:"/notes",label:"Notes"},{href:"/todo",label:"Todo"},{href:"/folders",label:"Folders"},{href:"/chat",label:"SAFe Chat"}].map(a=>(0,d.jsx)(h(),{href:a.href,className:`px-3 py-2 text-sm font-medium rounded-md transition-colors ${c===a.href?"bg-[var(--primary-green)] text-white":"text-[var(--muted-foreground)] hover:text-[var(--foreground)] hover:bg-[var(--muted)]"}`,children:a.label},a.href))})]}),(0,d.jsx)("div",{className:"flex-1 max-w-md mx-8",children:(0,d.jsx)(y,{onResultSelect:a=>{console.log("Selected search result:",a)},placeholder:"Search documents, notes, and todos...",showFilters:!0})}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)(m.$,{variant:"ghost",size:"icon",onClick:()=>r(!q),className:"relative",children:[(0,d.jsx)(i.A,{className:"w-5 h-5"}),o>0&&(0,d.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:o>9?"9+":o})]}),q&&(0,d.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-80 bg-[var(--card)] border border-[var(--border)] rounded-lg shadow-lg z-50",children:[(0,d.jsxs)("div",{className:"p-3 border-b border-[var(--border)] flex items-center justify-between",children:[(0,d.jsx)("h3",{className:"font-medium text-sm",children:"Notifications"}),o>0&&(0,d.jsx)(m.$,{variant:"ghost",size:"sm",onClick:x,disabled:s,className:"text-xs",children:"Mark all read"}),(0,d.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>r(!1),children:(0,d.jsx)(j.A,{className:"w-4 h-4"})})]}),(0,d.jsx)("div",{className:"max-h-80 overflow-y-auto",children:0===g.length?(0,d.jsx)("div",{className:"p-4 text-center text-[var(--muted-foreground)] text-sm",children:"No notifications yet"}):g.map(a=>(0,d.jsx)("div",{className:`p-3 border-b border-[var(--border)] hover:bg-[var(--muted)] cursor-pointer ${!a.read?"bg-blue-50 dark:bg-blue-900/20":""}`,onClick:()=>v(a.id),children:(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"font-medium text-sm",children:a.title}),a.message&&(0,d.jsx)("p",{className:"text-xs text-[var(--muted-foreground)] mt-1",children:a.message}),(0,d.jsx)("p",{className:"text-xs text-[var(--muted-foreground)] mt-2",children:(a=>{let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/36e5);if(c<1)return"Just now";if(c<24)return`${c}h ago`;let d=Math.floor(c/24);return d<7?`${d}d ago`:b.toLocaleDateString()})(a.created_at)})]}),!a.read&&(0,d.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-1"})]})},a.id))}),g.length>0&&(0,d.jsx)("div",{className:"p-3 border-t border-[var(--border)] text-center",children:(0,d.jsx)(h(),{href:"/notifications",className:"text-xs text-[var(--primary-green)] hover:underline",children:"View all notifications"})})]})]}),(0,d.jsx)(h(),{href:"/settings",children:(0,d.jsx)(m.$,{variant:"ghost",size:"icon",children:(0,d.jsx)(k.A,{className:"w-5 h-5"})})}),a&&(0,d.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,d.jsx)("div",{className:"text-sm",children:(0,d.jsx)("p",{className:"font-medium",children:a.user_metadata?.name||a.email})}),(0,d.jsx)(m.$,{variant:"ghost",size:"icon",onClick:b,children:(0,d.jsx)(l.A,{className:"w-5 h-5"})})]})]})]})}var A=c(85351),B=c(59405),C=c(15917),D=c(43700),E=c(3663),F=c(53256),G=c(55056),H=c(67770),I=c(8849);function J({folders:a,level:b=0}){let[c,e]=(0,f.useState)(new Set(["1","4","7"]));return(0,d.jsx)("div",{className:"space-y-1",children:a.map(a=>(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:`flex items-center space-x-2 p-2 rounded-md hover:bg-[var(--muted)] cursor-pointer group ${b>0?"ml-4":""}`,onClick:()=>a.children&&(a=>{let b=new Set(c);b.has(a)?b.delete(a):b.add(a),e(b)})(a.id),children:[a.children&&(0,d.jsx)(m.$,{variant:"ghost",size:"icon",className:"w-4 h-4 p-0",children:c.has(a.id)?(0,d.jsx)(A.A,{className:"w-3 h-3"}):(0,d.jsx)(B.A,{className:"w-3 h-3"})}),(0,d.jsx)(C.A,{className:"w-4 h-4 text-[var(--primary-green)]"}),(0,d.jsx)("span",{className:"text-sm flex-1",children:a.name}),a.documentCount&&a.documentCount>0&&(0,d.jsx)("span",{className:"text-xs text-[var(--muted-foreground)] bg-[var(--muted)] px-2 py-1 rounded-full",children:a.documentCount})]}),a.children&&c.has(a.id)&&(0,d.jsx)(J,{folders:a.children,level:b+1})]},a.id))})}function K(){let{user:a}=(0,w.A)(),[b,c]=(0,f.useState)([]),[e,g]=(0,f.useState)(!0);return(0,t.S)(),(0,d.jsxs)("aside",{className:"w-80 border-r border-[var(--border)] bg-[var(--card)] flex flex-col h-full",children:[(0,d.jsxs)("div",{className:"p-4 border-b border-[var(--border)]",children:[(0,d.jsx)("h2",{className:"font-semibold text-lg mb-4",children:"Quick Actions"}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(h(),{href:"/documents",children:(0,d.jsxs)(m.$,{className:"w-full justify-start",variant:"default",children:[(0,d.jsx)(D.A,{className:"w-4 h-4 mr-2"}),"Upload Document"]})}),(0,d.jsx)(h(),{href:"/notes",children:(0,d.jsxs)(m.$,{className:"w-full justify-start",variant:"outline",children:[(0,d.jsx)(E.A,{className:"w-4 h-4 mr-2"}),"New Note"]})}),(0,d.jsx)(h(),{href:"/todo",children:(0,d.jsxs)(m.$,{className:"w-full justify-start",variant:"outline",children:[(0,d.jsx)(F.A,{className:"w-4 h-4 mr-2"}),"Todo"]})}),(0,d.jsx)(h(),{href:"/chat",children:(0,d.jsxs)(m.$,{className:"w-full justify-start",variant:"outline",children:[(0,d.jsx)(G.A,{className:"w-4 h-4 mr-2"}),"SAFe Chat"]})}),(0,d.jsx)(h(),{href:"/folders",children:(0,d.jsxs)(m.$,{className:"w-full justify-start",variant:"outline",children:[(0,d.jsx)(H.A,{className:"w-4 h-4 mr-2"}),"New Folder"]})})]})]}),(0,d.jsxs)("div",{className:"p-4 border-b border-[var(--border)]",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsx)("h3",{className:"font-medium",children:"Folders"}),(0,d.jsx)(h(),{href:"/folders",children:(0,d.jsx)(m.$,{variant:"ghost",size:"icon",className:"w-6 h-6",children:(0,d.jsx)(I.A,{className:"w-4 h-4"})})})]}),(0,d.jsx)("div",{className:"max-h-96 overflow-y-auto scrollbar-hide",children:e?(0,d.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,d.jsx)("div",{className:"w-4 h-4 border-2 border-[var(--primary-green)] border-t-transparent rounded-full animate-spin"})}):0===b.length?(0,d.jsxs)("div",{className:"text-center py-4 text-[var(--muted-foreground)]",children:[(0,d.jsx)(C.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,d.jsx)("p",{className:"text-xs",children:"No folders yet"}),(0,d.jsx)(h(),{href:"/folders",className:"text-xs text-[var(--primary-green)] hover:underline",children:"Create your first folder"})]}):(0,d.jsx)(J,{folders:b})})]})]})}function L({onClick:a,isOpen:b}){return(0,d.jsx)("div",{className:"fixed bottom-6 right-6 z-50",children:(0,d.jsxs)(m.$,{onClick:a,className:`
          relative h-14 w-14 rounded-full shadow-lg transition-all duration-300 ease-in-out
          ${b?"bg-[var(--error-red)] hover:bg-[var(--error-red)] scale-110":"bg-[var(--primary-green)] hover:bg-[var(--dark-green)] hover:scale-110"}
          group
        `,"aria-label":b?"Close AI Chat":"Open AI Chat",children:[!b&&(0,d.jsx)("div",{className:"absolute inset-0 rounded-full bg-[var(--primary-green)] animate-ping opacity-20"}),(0,d.jsx)("div",{className:`transition-transform duration-300 ${b?"rotate-180":"rotate-0"}`,children:b?(0,d.jsx)(j.A,{className:"h-6 w-6 text-white"}):(0,d.jsx)(G.A,{className:"h-6 w-6 text-white group-hover:scale-110 transition-transform"})}),(0,d.jsx)("div",{className:`
          absolute bottom-full right-0 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded
          whitespace-nowrap opacity-0 pointer-events-none transition-opacity duration-200
          group-hover:opacity-100
        `,children:b?"Close AI Chat":"Ask SAFe AI"})]})})}var M=c(88386),N=c(10578),O=c(71563);function P({isOpen:a,onClose:b}){let[c,e]=(0,f.useState)([]),[g,h]=(0,f.useState)(""),[i,k]=(0,f.useState)(!1),[l,n]=(0,f.useState)(!1),o=(0,f.useRef)(null),{user:q}=(0,w.A)(),r=async a=>{let b=a||g.trim();if(!b||!q)return;let c={id:Date.now().toString(),role:"user",content:b,timestamp:new Date},d=(Date.now()+1).toString(),f={id:d,role:"assistant",content:"",timestamp:new Date};e(a=>[...a,c,f]),h(""),k(!0);try{let a=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:b,userId:q.id})});if(!a.ok)throw Error("Failed to get response");let c=await a.json();e(a=>a.map(a=>a.id===d?{...a,content:c.response}:a))}catch(a){console.error("Error sending message:",a),e(a=>a.map(a=>a.id===d?{...a,content:"Sorry, I encountered an error. Please try again."}:a))}finally{k(!1)}};return a?(0,d.jsx)("div",{className:"fixed bottom-24 right-6 z-40",children:(0,d.jsxs)("div",{className:`
        bg-[var(--card)] border border-[var(--border)] rounded-lg shadow-xl
        transition-all duration-300 ease-in-out
        ${l?"w-80 h-16":"w-96 h-[500px]"}
      `,children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-[var(--border)]",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("div",{className:"w-6 h-6 bg-[var(--accent-blue)] rounded-full flex items-center justify-center",children:(0,d.jsx)(G.A,{className:"w-4 h-4 text-white"})}),(0,d.jsx)("span",{className:"font-medium text-sm",children:"SAFe AI Assistant"})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,d.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>n(!l),className:"h-6 w-6 p-0 hover:bg-[var(--muted)]",children:(0,d.jsx)(M.A,{className:"h-3 w-3"})}),(0,d.jsx)(m.$,{variant:"ghost",size:"sm",onClick:b,className:"h-6 w-6 p-0 hover:bg-[var(--muted)]",children:(0,d.jsx)(j.A,{className:"h-3 w-3"})})]})]}),!l&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 h-[360px]",children:[c.map(a=>(0,d.jsxs)("div",{className:`flex space-x-2 ${"user"===a.role?"justify-end":"justify-start"}`,children:["assistant"===a.role&&(0,d.jsx)("div",{className:"w-6 h-6 bg-[var(--accent-blue)] rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:(0,d.jsx)(G.A,{className:"w-4 h-4 text-white"})}),(0,d.jsxs)("div",{className:`max-w-[75%] p-3 rounded-lg text-sm ${"user"===a.role?"bg-[var(--primary-green)] text-white":"bg-[var(--muted)] border border-[var(--border)]"}`,children:[(0,d.jsx)("div",{className:"whitespace-pre-wrap",children:a.content}),(0,d.jsx)("p",{className:"text-xs opacity-70 mt-1",children:a.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),"user"===a.role&&(0,d.jsx)("div",{className:"w-6 h-6 bg-[var(--primary-green)] rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:(0,d.jsx)(N.A,{className:"w-4 h-4 text-white"})})]},a.id)),i&&(0,d.jsxs)("div",{className:"flex space-x-2 justify-start",children:[(0,d.jsx)("div",{className:"w-6 h-6 bg-[var(--accent-blue)] rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:(0,d.jsx)(G.A,{className:"w-4 h-4 text-white"})}),(0,d.jsx)("div",{className:"max-w-[75%] p-3 rounded-lg bg-[var(--muted)] border border-[var(--border)]",children:(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("div",{className:"w-3 h-3 border-2 border-[var(--primary-green)] border-t-transparent rounded-full animate-spin"}),(0,d.jsx)("span",{className:"text-sm",children:"Analyzing..."})]})})]}),(0,d.jsx)("div",{ref:o})]}),(0,d.jsx)("div",{className:"p-4 border-t border-[var(--border)]",children:(0,d.jsxs)("div",{className:"flex space-x-2",children:[(0,d.jsx)(p.p,{value:g,onChange:a=>h(a.target.value),placeholder:"Ask about SAFe practices...",onKeyDown:a=>"Enter"===a.key&&!i&&r(),className:"flex-1 text-sm",disabled:i}),(0,d.jsx)(m.$,{onClick:()=>r(),disabled:i||!g.trim(),size:"sm",className:"px-3",children:(0,d.jsx)(O.A,{className:"w-3 h-3"})})]})})]})]})}):null}function Q({children:a}){let b=(0,e.usePathname)(),[c,g]=(0,f.useState)(!1);return(0,d.jsxs)("div",{className:"main-layout-container bg-[var(--background)]",children:[(0,d.jsx)(z,{}),(0,d.jsxs)("div",{className:"main-content-area",children:[(0,d.jsx)(K,{}),(0,d.jsx)("main",{className:"flex-1 overflow-y-auto",children:a})]}),"/chat"!==b&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(L,{onClick:()=>g(!c),isOpen:c}),(0,d.jsx)(P,{isOpen:c,onClose:()=>g(!1)})]})]})}},30295:(a,b,c)=>{"use strict";c.d(b,{W:()=>f});var d=c(20814);class e{async getDocuments(a,b){let c=this.supabase.from("documents").select("*").eq("user_id",a).order("updated_at",{ascending:!1});c=b?c.eq("folder_id",b):c.is("folder_id",null);let{data:d,error:e}=await c;if(e)throw Error(`Failed to fetch documents: ${e.message}`);return d}async getDocument(a,b){let{data:c,error:d}=await this.supabase.from("documents").select("*").eq("id",a).eq("user_id",b).single();if(d)throw Error(`Failed to fetch document: ${d.message}`);return c}async createDocument(a){let{data:b,error:c}=await this.supabase.from("documents").insert(a).select().single();if(c)throw Error(`Failed to create document: ${c.message}`);return b}async updateDocument(a,b,c){let{data:d,error:e}=await this.supabase.from("documents").update(b).eq("id",a).eq("user_id",c).select().single();if(e)throw Error(`Failed to update document: ${e.message}`);return d}async deleteDocument(a,b){let{data:c,error:d}=await this.supabase.from("documents").select("file_url").eq("id",a).eq("user_id",b).single();if(d)throw Error(`Failed to fetch document for deletion: ${d.message}`);let e=c.file_url.split("/").slice(-2).join("/"),{error:f}=await this.supabase.storage.from("documents").remove([e]);f&&console.warn("Failed to delete file from storage:",f.message);let{error:g}=await this.supabase.from("documents").delete().eq("id",a).eq("user_id",b);if(g)throw Error(`Failed to delete document: ${g.message}`);return{success:!0}}async searchDocuments(a,b,c){let d=this.supabase.from("documents").select("*").eq("user_id",a);b&&(d=d.or(`title.ilike.%${b}%,content.ilike.%${b}%`)),c&&(c.artifactType&&(d=d.eq("artifact_type",c.artifactType)),c.priority&&(d=d.eq("priority",c.priority)),c.folderId&&(d=d.eq("folder_id",c.folderId)),c.tags&&c.tags.length>0&&(d=d.overlaps("tags",c.tags))),d=d.order("updated_at",{ascending:!1});let{data:e,error:f}=await d;if(f)throw Error(`Failed to search documents: ${f.message}`);return e}async getDocumentsByTag(a,b){let{data:c,error:d}=await this.supabase.from("documents").select("*").eq("user_id",a).contains("tags",[b]).order("updated_at",{ascending:!1});if(d)throw Error(`Failed to fetch documents by tag: ${d.message}`);return c}async getDocumentsByArtifactType(a,b){let{data:c,error:d}=await this.supabase.from("documents").select("*").eq("user_id",a).eq("artifact_type",b).order("updated_at",{ascending:!1});if(d)throw Error(`Failed to fetch documents by artifact type: ${d.message}`);return c}async updateDocumentTags(a,b,c){return this.updateDocument(a,{tags:b},c)}async updateDocumentArtifactType(a,b,c){return this.updateDocument(a,{artifact_type:b},c)}async updateDocumentPriority(a,b,c){return this.updateDocument(a,{priority:b},c)}async moveDocumentToFolder(a,b,c){return this.updateDocument(a,{folder_id:b},c)}async getDocumentStats(a){let{data:b,error:c}=await this.supabase.from("documents").select("artifact_type, priority, file_type").eq("user_id",a);if(c)throw Error(`Failed to fetch document stats: ${c.message}`);let d={total:b.length,byArtifactType:{},byPriority:{},byFileType:{}};return b.forEach(a=>{a.artifact_type&&(d.byArtifactType[a.artifact_type]=(d.byArtifactType[a.artifact_type]||0)+1),a.priority&&(d.byPriority[a.priority]=(d.byPriority[a.priority]||0)+1),d.byFileType[a.file_type]=(d.byFileType[a.file_type]||0)+1}),d}constructor(){this.supabase=(0,d.S)()}}let f=new e},35284:(a,b,c)=>{"use strict";c.d(b,{$:()=>j});var d=c(21124),e=c(38301),f=c(96425),g=c(26691),h=c(44943);let i=(0,g.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-[var(--primary-green)] text-white hover:bg-[var(--dark-green)]",destructive:"bg-[var(--error-red)] text-white hover:bg-red-600",outline:"border border-[var(--border)] bg-background hover:bg-[var(--secondary)] hover:text-[var(--secondary-foreground)]",secondary:"bg-[var(--secondary)] text-[var(--secondary-foreground)] hover:bg-[var(--secondary)]/80",ghost:"hover:bg-[var(--secondary)] hover:text-[var(--secondary-foreground)]",link:"text-[var(--primary-green)] underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),j=e.forwardRef(({className:a,variant:b,size:c,asChild:e=!1,...g},j)=>{let k=e?f.DX:"button";return(0,d.jsx)(k,{className:(0,h.cn)(i({variant:b,size:c,className:a})),ref:j,...g})});j.displayName="Button"},44943:(a,b,c)=>{"use strict";c.d(b,{cn:()=>f,eX:()=>j,fK:()=>i,oP:()=>h,z3:()=>g});var d=c(43249),e=c(58829);function f(...a){return(0,e.QP)((0,d.$)(a))}function g(a){if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["Bytes","KB","MB","GB"][b]}function h(a){return a&&({pdf:"\uD83D\uDCC4",docx:"\uD83D\uDCDD",txt:"\uD83D\uDCC4",md:"\uD83D\uDCDD",mp3:"\uD83C\uDFB5",wav:"\uD83C\uDFB5",mp4:"\uD83C\uDFA5"})[a.toLowerCase()]||"\uD83D\uDCC4"}function i(a){return({Epic:"bg-purple-100 text-purple-800",Feature:"bg-blue-100 text-blue-800","User Story":"bg-green-100 text-green-800",Capability:"bg-orange-100 text-orange-800",Solution:"bg-red-100 text-red-800",Theme:"bg-yellow-100 text-yellow-800",Enabler:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800"}function j(a){return({High:"text-red-600",Medium:"text-yellow-600",Low:"text-green-600"})[a]||"text-gray-600"}},48152:(a,b,c)=>{"use strict";c.d(b,{d:()=>f});var d=c(26873),e=c(86802);let f=async()=>{let a=await (0,e.UL)();return(0,d.createServerClient)("https://nugjghwkvfkdbgrgsazv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51Z2pnaHdrdmZrZGJncmdzYXp2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5MjM3NzMsImV4cCI6MjA3MzQ5OTc3M30.6iaRtFDTdss9YgKaPYnP63A1TC2FNqN4ywPlRnrrssA",{cookies:{get:b=>a.get(b)?.value,set(b,c,d){try{a.set({name:b,value:c,...d})}catch(a){}},remove(b,c){try{a.set({name:b,value:"",...c})}catch(a){}}}})}},48294:(a,b,c)=>{Promise.resolve().then(c.bind(c,76042))},51472:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>k,metadata:()=>j});var d=c(75338),e=c(7840),f=c.n(e),g=c(33550),h=c.n(g);c(61135);var i=c(98580);let j={title:"Document AI Assistant",description:"AI-powered document management for Product Owners in SAFe and Agile environments"};function k({children:a}){return(0,d.jsx)("html",{lang:"en",className:"h-full",children:(0,d.jsx)("body",{className:`${f().variable} ${h().variable} antialiased h-full`,children:(0,d.jsx)(i.AuthProvider,{children:(0,d.jsx)("div",{className:"h-full",children:a})})})})}},61135:()=>{},62186:(a,b,c)=>{"use strict";c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-lg border border-[var(--border)] bg-[var(--card)] text-[var(--card-foreground)] shadow-sm",a),...b}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-[var(--muted-foreground)]",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b})).displayName="CardFooter"},70440:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>e});var d=c(97523);let e=async a=>[{type:"image/x-icon",sizes:"16x16",url:(0,d.fillMetadataSegment)(".",await a.params,"favicon.ico")+""}]},76042:(a,b,c)=>{"use strict";c.d(b,{A:()=>i,AuthProvider:()=>j});var d=c(21124),e=c(38301),f=c(42378),g=c(20814);let h=(0,e.createContext)({user:null,session:null,loading:!0,signOut:async()=>{}}),i=()=>{let a=(0,e.useContext)(h);if(!a)throw Error("useAuth must be used within an AuthProvider");return a};function j({children:a}){let[b,c]=(0,e.useState)(null),[i,j]=(0,e.useState)(null),[k,l]=(0,e.useState)(!0),[m,n]=(0,e.useState)(!0),o=(0,f.useRouter)();(0,f.usePathname)();let p=(0,g.S)(),q=async()=>{try{await p.auth.signOut()}catch(a){console.error("Error signing out:",a),o.push("/auth/login")}};return(0,d.jsx)(h.Provider,{value:{user:b,session:i,loading:k,signOut:q},children:a})}},83335:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},93758:(a,b,c)=>{"use strict";c.d(b,{p:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,type:b,...c},e)=>(0,d.jsx)("input",{type:b,className:(0,f.cn)("flex h-10 w-full rounded-md border border-[var(--border)] bg-[var(--input)] px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-[var(--muted-foreground)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--primary-green)] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));g.displayName="Input"},98580:(a,b,c)=>{"use strict";c.d(b,{AuthProvider:()=>e});var d=c(97954);(0,d.registerClientReference)(function(){throw Error("Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/paulojuri/document-ai-assistant/src/components/auth/auth-provider.tsx","useAuth");let e=(0,d.registerClientReference)(function(){throw Error("Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/paulojuri/document-ai-assistant/src/components/auth/auth-provider.tsx","AuthProvider")},99187:(a,b,c)=>{"use strict";c.d(b,{E:()=>h});var d=c(21124);c(38301);var e=c(26691),f=c(44943);let g=(0,e.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-[var(--primary-green)] text-white hover:bg-[var(--dark-green)]",secondary:"border-transparent bg-[var(--secondary)] text-[var(--secondary-foreground)] hover:bg-[var(--secondary)]/80",destructive:"border-transparent bg-[var(--error-red)] text-white hover:bg-red-600",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("div",{className:(0,f.cn)(g({variant:b}),a),...c})}}};